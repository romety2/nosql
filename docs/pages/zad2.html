<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<meta charset="utf-8">
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
	<meta name="generator" content="pandoc"/>
  <title>Technologie NoSQL</title>
  <link rel="stylesheet" href="../style/style.css">
</head>
<body>
	<div class = "return">
		<a href="../index.html">powrót</a>
	</div>
	<div class = "description">
		<h1 class="text-center">Zadanie 2 (Aggregation Pipeline)</h1>
		</br>
		<p class="description-team">
			To zadanie zostało wykonane w dwuosobowym zespole o składzie Łukasz Mielewczyk oraz Marek Białousz.
			</br>
			Do rozwiązania zadania została wykorzystana baza danych <i>mongoDB</i>.
			</br>
			Każdy z nas pracował na różnych danych oraz porównywaliśmy wyniki.
			</br>
		</p>
		<div class="menu">
			<ul>
				<li><a href="#iod">Informacje o danych</a></li>
				<li><a href="#iiko">Instalacja i konfiguracja oprogramowania</a></li>
				<ul>
					<li><a href="#iiko1">mongoDB</a></li>
				</ul>
				<li><a href="#mdb-lm">mongoDB (Łukasz Mielewczyk)</a></li>
				<ul>
					<li><a href="#mdb-lm1">import danych</a></li>
					<li><a href="#mdb-lm2">przykładowy rekord</a></li>
					<li><a href="#mdb-lm3">ilość danych</a></li>
					<li><a href="#mdb-lm4">sortowanie</a></li>
					<li><a href="#mdb-lm5">szukanie danych</a></li>
					<li><a href="#mdb-lm6">sortowanie konretnych danych</a></li>
					<li><a href="#mdb-lm7">sumowanie</a></li>
				</ul>
				<li><a href="#mdb-mb">mongoDB (Marek Białousz)</a></li>
				<ul>
				</ul>
			</ul>
		</div>
		<h2 id="iod">Informacje o danych</h2>	
		<p class="description-data">
			Dane zawierają informacje o transakcjach.
			<a href="https://dl.dropboxusercontent.com/u/15056258/mongodb/trades.json" download>Pobierz</a>.
			</br>
			Rozmiar: 230 MB
			</br>
			Ilość: 1000001
		</p>
		</br>
		<h2 id="iiko">Instalacja i konfiguracja oprogramowania</h2>
		<h3 id="iiko1">mongoDB</h3>
		<p>
		
			Do rozwiązania zadania użyto bazy mongoDB. Należy ją pobrać ze 
			<a href="https://www.mongodb.com/download-center#community" target="_blank">strony</a>
			i zainstalować. Następnie aby uruchomić bazę danych, należy w konsoli <i>cmd</i> i wydać polecenie: 
			<div class="command">
				<code>
mongod
				</code>
			</div>
		</p>
		</br>
		<h2 id="mdb-lm">mongoDB (Łukasz Mielewczyk)</h2>
		<h3 id="mdb-lm1">import danych</h3>
		<p>
			Następnie aby zaimportwać z pliku do bazy danych (oczywiście baza danych musi być uruchomiona) należy wydać w <i>cmd</i> polecenie:
			<div class="command">
				<code>
mongoimport --db test --collection test --file trades.json
				</code>
			</div>
			Również i import powodował duże zużycie zasobów (ilustracja niżej):
			</br></br>
			<div class="text-center">
				<img src="../images/screen4.PNG" height="400em" width="500em">
			</div>
			<div class="description-image">Procesor podczas importu danych do mongoDB</div>
			</br></br>
			<div class="text-center">
				<img src="../images/screen5.PNG" height="400em" width="500em">
			</div>
			<div class="description-image">Pamięć podczas importu danych do mongoDB</div>
			</br></br>
			<div class="text-center">
				<img src="../images/screen6.PNG" height="400em" width="500em">
			</div>
			<div class="description-image">Dysk podczas importu danych do mongoDB</div>
			</br></br>
			Wykonanie trwało ok. 2 minut.
			</br>
			Ostatecznie pojawił się komunikat: "imported 1000001 documents"
			</br></br>
		</p>
		</br>
		<h3 id="mdb-lm2">przykładowe pole</h3>
		<p>
			Aby wyświetlić przykładową daną, początkowo trzeba włączyć mongo shell. Polecenie:
			<div class="command">
				<code>
mongo
				</code>
			</div>
			Następnie należy wykonać polecenie:
			<div class="command">
				<code>		
db.test.aggregate( { $limit: 1 } )
				</code>
			</div>
			Wówczas otrzymano:
			<div class="text-center">
				<img src="../images/screen19.PNG" height="50em" width="1200em">
			</div>
			<div class="description-image">Wynik wyświetlenia pierwszego rekordu w MongoDB</div>
		</p>
		</br>
		<h3 id="mdb-lm3">ilość danych</h3>
		<p>
			Aby zobaczyć ilość danych wykorzystano polecenie:
			<div class="command">
				<code>
db.test.aggregate([{ $group: { _id: null , count: { $sum: 1 }}}])
				</code>
			</div>
			Otrzymano:
			<div class="code">
				<pre>
					<code>
{ "_id" : null, "count" : 1000001 }
					</code>
				</pre>
			</div>
			Wykonanie trwało ok. 10 sekund.
		</p>
		</br>
		<h3 id="mdb-lm4">sortowanie</h3>
		<p>
			Wyświetlimy pierwszych 10 najdroższych transakcji, polecenie:
			<div class="command">
				<code>
db.test.aggregate( { $sort: { price: -1 } }, { $limit: 10 } )
				</code>
			</div>
			Wykonanie trwało ok. 30 sekund.
			</br></br>
			Ostatecznie uzyskano:
			</br></br>
			<div class="text-center">
				<img src="../images/screen20.PNG" height="250em" width="1200em">
			</div>
			<div class="description-image">Wynik sortowania w MongoDB</div>
		</p>
		</br>
		<h3 id="mdb-lm5">szukanie danych</h3>
		<p>
			Wyświetlimy dane gdzie <i>ticket</i> jest równe <i>z433</i>:
			<div class="command">
				<code>
db.test.aggregate( { $match: { ticket: "z433" } }, { $limit: 10 } )
				</code>
			</div>
			To zapytanie również zostało wykonane w mgnieniu oka.
			</br></br>
			Ostatecznie uzyskano:
			</br></br>
			<div class="text-center">
				<img src="../images/screen21.PNG" height="250em" width="1200em">
			</div>
			<div class="description-image">Wynik znalezionych danych w MongoDB</div>
		</p>
		<h3 id="mdb-lm6">sortowanie konretnych danych</h3>
		<p>
			Wyświetlimy dane gdzie <i>ticket</i> jest równe <i>z109</i> oraz posortowano je wg ceny:
			<div class="command">
				<code>
db.test.aggregate( { $match: { ticket: "z109" } }, { $sort: { price: -1 } }, { $limit: 10 } )
				</code>
			</div>
			Wykonanie trwało ok. 5 sekund.
			</br></br>
			Ostatecznie uzyskano:
			</br></br>
			<div class="text-center">
				<img src="../images/screen22.PNG" height="250em" width="1200em">
			</div>
			<div class="description-image">Wynik znalezionych i posortowanych danych w MongoDB</div>
		</p>
		<h3 id="mdb-lm6">sumowanie</h3>
		<p>
		<p>
			Będziemy teraz sumować ceny w danych, w tym celu musimy pogrupować dane wg biletów, polecenie:
			<div class="command">
				<code>
db.test.aggregate( { $group: { _id: "$ticket", total: { $sum: "$price" } } } )
				</code>
			</div>
			Wykonanie trwało ok. 5 sekund.
			</br></br>
			Ostatecznie uzyskano:
			</br></br>
			<div class="text-center">
				<img src="../images/screen23.PNG" height="250em" width="300em">
			</div>
			<div class="description-image">Wynik sumowania danych w MongoDB</div>
		</p>
		</p>
		<h2 id="mdb-mb">mongoDB (Marek Białousz)</h2>		
	</div>
	</br>
	<div class = "return">
		<a href="../index.html">powrót</a>
	</div>
</body>